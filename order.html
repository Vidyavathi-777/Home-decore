<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Orders - Ivory Nest</title>
    <link rel="stylesheet" href="order.css" />
</head>
<body>
    <header class="header-section">
        <nav class="navbar">
            <ul class="nav-list">
                <li>SHOP</li>
                <li>INSPIRATION</li>
                <li>IVORY HOUSE</li>
                <li>SAMPLES</li>
                <li>PROFESSIONALS</li>
            </ul>
        </nav>
        <h1><a href="index.html" class="logo">Ivory Nest</a></h1>
    </header>

    <main class="orders-container">
        <h2>My Orders</h2>
        <div id="orders-list"></div>
    </main>

    <footer id="footer">
        <section class="details">
            <div class="company">
                <ul>
                    <li>About Ivory Nest</li>
                    <li>Contact</li>
                </ul>
            </div>
        </section>
    </footer>

    <script>
        // Function to load orders from API
        async function loadOrders() {
            try {
                const response = await fetch("https://home-decor-tqze.onrender.com/my-orders", {
                    method: "GET",
                    headers: {
                        "Content-Type": "application/json"
                    }
                });

                if (!response.ok) {
                    throw new Error("Failed to fetch orders");
                }

                const orders = await response.json();
                displayOrders(orders);
            } catch (error) {
                console.error("Error:", error);
                document.getElementById('orders-list').innerHTML = '<p>Error loading orders. Please try again later.</p>';
            }
        }

        // Function to display the orders on the page
        function displayOrders(orders) {
            const ordersList = document.getElementById('orders-list');
            if (orders.length === 0) {
                ordersList.innerHTML = '<p>You have no orders yet.</p>';
                return;
            }

            ordersList.innerHTML = '';
            orders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.classList.add('order-item');
                
                orderDiv.innerHTML = `
                    <h3>Order #${order.id}</h3>
                    <p>Status: ${order.status}</p>
                    <p>Placed on: ${new Date(order.date).toLocaleDateString()}</p>
                    <ul>
                        ${order.products.map(product => `
                            <li>
                                <img src="${product.image}" alt="${product.name}" />
                                <span>${product.name}</span>
                                <span>Quantity: ${product.quantity}</span>
                                <span>Price: $${product.price}</span>
                            </li>
                        `).join('')}
                    </ul>
                    <p>Total: $${order.total}</p>
                `;
                ordersList.appendChild(orderDiv);
            });
        }

        // Load orders on page load
        window.onload = loadOrders;
    </script>
</body>
</html>
